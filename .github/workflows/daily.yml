name: Daily Morning Alert

on:
  schedule:
    - cron: "0 0 * * *"  # UTC 00:00 â†’ KST 09:00
  workflow_dispatch: {}    # ìˆ˜ë™ ì‹¤í–‰ ê°€ëŠ¥

jobs:
  daily_alert:
    runs-on: ubuntu-latest
    steps:
      - name: Send morning embed
        run: |
          NOW_KST=$(date -d '+9 hours' '+%Y-%m-%d %H:%M:%S')
          HOUR=$(date -d '+9 hours' '+%H')

          # 09ì‹œ ì´í›„ì—ë§Œ ë°œì†¡
          if [ "$HOUR" -lt 9 ]; then
            echo "ì•„ì§ 09ì‹œê°€ ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. (${NOW_KST})"
            exit 0
          fi

          PAYLOAD=$(jq -n \
            --arg now "$NOW_KST" \
            '{
              content: "ğŸŒ ì˜¤ëŠ˜ í•˜ë£¨ë„ í˜ë‚´ì„¸ìš”~",
              embeds: [
                {
                  title: "ì¼ì¼ & ì£¼ê°„ ì¤‘ìš” êµí™˜ ì•ˆë‚´",
                  description: "ìˆ˜ë™ í™•ì¸ ì‹œê°: \($now)",
                  color: 3447003,
                  fields: [
                    {name: "ì¼ì¼ ë¬´ë£Œ ìºì‹œìƒµ", value: "ì¡°ê°ë‚œ ë³´ì„ ë³´ë¬¼ìƒì, ì¼ì¼ ë¬´ë£Œ íŒ¨ì…˜", inline: true},
                    {name: "ì¼ì¼", value: "[ë©”ì´ë¸] ì„±ìˆ˜ 1ê°œ, [ì—”ë¸ë¦¬ì˜¨] ì„±ìˆ˜10ê°œ", inline: true},
                    {name: "ì£¼ê°„", value: "[ì—¬ê´€ ë° ì„±ë‹¹] ì„±ìˆ˜, [ë¼ì‚¬ ë° ìŠ¤íŠœì–´íŠ¸] ê°•í™” ë¹„ì•½ ìœ í™”ì œ", inline: false}
                  ],
                  footer: {text: "ì •ë³´ ì—…ë°ì´íŠ¸ ìš”ì²­ì€ ìœ¤ê³°ì—ê²Œ"}
                }
              ]
            }')

          curl -H "Content-Type: application/json" \
               -X POST \
               -d "$PAYLOAD" \
               ${{ secrets.DISCORD_WEBHOOK_URL }}
